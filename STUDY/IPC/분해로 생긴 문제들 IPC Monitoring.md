# 분해로 인해 달라진 것들

## 1. 모듈간 통신 -> 서비(프로세스) 간 통신
- Method(Function) Call 
  - -> Network(http, grpc, ...)

- MSA 는 결국 리소스를 나눠서 사용하므로 각각의 서버 리소스가 낭비가 되거나 부족해질 수 있다
- 최적화 하기 어렵다!

### 발생 가능한 문제들 1
- **요청에 대한 처리량 (throughput)이 급격히 하락**
    - 각 서비스의 정확한 필요한 컴퓨팅 리소스 파악 어려움
    - **필요한 컴퓨팅 자원의 최적화 어려움** -> **성능 하락 가능성**
- **http, grpc 프로토콜 상의 이슈**로 **디버깅 어려움**
  - Connection Pool 관리
  - 만약 JVM의 한정된 리소스로 잘 사용하였는데, JVM 최적화가 더 어려워짐 
    - 의도치 않은 결과 발생 가능성
  - 개발자가 http, grpc 프로토콜에 디펜던시가 있는 지식 필요!
    - Connection timeout, tcp-3handshake 이해, grpc code , ....

## 2. 모니터링 방식의 변경
- 정형화된 로그, 메트릭 수집 방식
  - 모놀리식 환경에서는 
    - Node Exporter를 활용하여, Node(DB) 상태에 집중 
  - MSA 환경에서는
    - Node 상태 뿐만이 아니라, 서비스 간 호출 상태 파악을 해야한다
      - Latency 증감 확인, Call 증감 확인
      - 어떤 API 호출중인지 확인 
      - Async 방식 등에 대해서도 모니터링 필요
        - 카프카 큐잉
      - 다양한 비즈니스 메트릭에 대해서도 어려워짐 

### 발생 가능한 문제들 2

- hop 이 늘어남에 따라, **어디서 어떤 요청에 대한 문제가 발생했는지** 파악하기 어렵다 
  - 서비스 갯수가 늘어나면서, 어느 요청에서 문제가 발생했는지?
- 로그 수집을 위한 별도의 인프라 필요 및 관리 필요성
  - 비교적 간단한 로깅 파이프라인에서
  - 괸장히 복잡하고, 처리해야할 많은 문제들 발생(e.x. 누락)
- 수십, 수백개의 서비스에 대해 **JVM/하드웨어가 얼마나 정상적인지 지속적인 확인**이 필요하다!
  - 서비스 또는 서버에 문제가 생기더라도 적절하게 문제 감지가 어렵다.
- **어느 서비스에서 어느 서비스로 호출이 되어야 하는지**, 이게 정상인지 확인이 필요하다
  - 서비스 간 호출 상태가 옳은 상태인지, 엉뚱한 서비스를 호출하지는 않는지 파악이 어렵다


